# Makefile
#
# Generated by phxrpc_pb2server from mqtt.proto
#
#

include ../../../../makefile.mk

LDFLAGS := -L$(PHXRPC_ROOT)/lib -lphxrpc $(LDFLAGS)

OBJS = table_mgr.o \
		misc.o \
		mqtt.pb.o

all: libphxqueue_phxrpc_logic_mqtt.a

libphxqueue_phxrpc_logic_mqtt.a: $(OBJS)
	$(AR) $@ $^

%.pb.o: %.pb.cc
	$(CXX) $(CXXFLAGS) -o $@ -c $< -I$(PROTOBUF_INCLUDE_DIR) -I$(PHXRPC_INCLUDE_DIR) \
			-I$(PHXQUEUE_INCLUDE_DIR) -I.

%.o: %.cpp
	$(CXX) $(CXXFLAGS) -o $@ -c $< -I$(GLOG_INCLUDE_DIR) -I$(PROTOBUF_INCLUDE_DIR) \
			-I$(LEVELDB_INCLUDE_DIR) -I$(LIBCO_INCLUDE_DIR) -I$(PHXRPC_INCLUDE_DIR) \
			-I$(PHXPAXOS_INCLUDE_DIR) -I$(PHXPAXOS_PLUGIN_INCLUDE_DIR) -I$(PHXQUEUE_INCLUDE_DIR)

########## message ##########

pb: mqtt.pb.cc mqtt.pb.h

mqtt.pb.cc: mqtt.pb.h

mqtt.pb.h: mqtt.proto
	(cd $(PHXQUEUE_BASE_DIR); $(PROTOBUF_BIN_DIR)/protoc $(addprefix phxqueue_phxrpc/app/logic/mqtt/,$^) --proto_path=. --proto_path=$(PHXRPC_INCLUDE_DIR) --proto_path=$(PHXQUEUE_INCLUDE_DIR) --proto_path=$(PROTOBUF_INCLUDE_DIR) --cpp_out=.)

clean:
	@($(RM) $(TARGETS))
	@($(RM) *.o)
	@($(RM) *.pb.*)

